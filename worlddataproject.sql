-- REQUIREMENT 1 AND 2
CREATE DATABASE worldfactbook;

USE worldfactbook

-- TABLE 1 : WORLD FACTS 
CREATE TABLE worldfacts(
    id INTEGER NOT NULL ,
	area_land integer,
    area_water integer, 
    population integer, 
    population_growth float, 
    birth_rate float, 
    death_rate float, 
    migration_rate float,
	city_code varchar(255) NOT NULL, 
    city_name varchar(255) NOT NULL, 
    city_area integer, 
    PRIMARY KEY (id)
);

-- first, let us show some descriptions for some of the columns:
--     name — the name of the country.
--   area — the total land and sea area of the country.
--   population — the country's population.
--   population_growth— the country's population growth as a percentage.
--   birth_rate — the country's birth rate, or the number of births a year per 1,000 people.
--   death_rate — the country's death rate, or the number of death a year per 1,000 people.
--   area— the country's total area (both land and water).
--   area_land — the country's land area in square kilometers.
--   area_water — the country's water area in square kilometers.

INSERT INTO worldfacts
(id, area_land, area_water, population, population_growth,
birth_rate, death_rate, migration_rate, city_code, city_name,city_area)
VALUES
(1,	652230,	0,	32564342,	2.32,	38.57,	13.89,	1.51,	'af',	'Afghanistan',	652230),
(2,	27398,	1350,	3029278,	0.3,	12.92,	6.58,	3.3,	'al',	'Albania',	28748),
(3,	2381741,	0,	39542166,	1.84,	23.67,	4.31,	0.92,	'ag',	'Algeria',	2381741),
(4,	468,	0,	85580,	0.12,	8.13,	6.96,	0,	'an',	'Andorra',	468),
(5,	1246700,	0,	19625353,	2.78,	38.78,	11.49,	0.46,	'ao',	'Angola',	1246700),
(6,	442,	0,	92436,	1.24,	15.85,	5.69,	2.21,	'ac',	'AntiguaandBarbuda',	442),
(7,	2736690,	43710,	43431886,	0.93,	16.64,	7.33,	0,	'ar',	'Argentina',	2780400),
(8,	28203,	1540,	3056382,	0.15,	13.61,	9.34,	5.8,	'am',	'Armenia',	29743);

INSERT INTO worldfacts
(id, area_land, area_water, population, population_growth,
birth_rate, death_rate, migration_rate, city_code, city_name,city_area)
VALUES
(9,	7682300,	58920,	22751014,	1.07,	12.15,	7.14,	5.65,	'as',	'Australia',	7741220),
(10,	82445,	1426,	8665550,	0.55,	9.41,	9.42,	5.56,	'au',	'Austria',	83871),
(11,	82629,	3971,	9780780,	0.96,	16.64,	7.07,	0,	'aj',	'Azerbaijan',	86600),
(12,	10010,	3870,	324597,	0.85,	15.5,	7.05,	0,	'bf',	'Bahamas_The',	13880),
(13,	760,	0,	1346613,	2.41,	13.66,	2.69,	13.09,	'ba',	'Bahrain',	760),
(14,	130170,	18290,	168957745,	1.6,	21.14,	5.61,	0.46,	'bg',	'Bangladesh',	148460),
(15,	430,	0,	290604,	0.31,	11.87,	8.44,	0.3,	'bb',	'Barbados',	430),
(16,	202900,	4700,	9589689,	0.2,	10.7,	13.36,	0.7,	'bo',	'Belarus',	207600),
(17,	30278,	250,	11323973,	0.76,	11.41,	9.63,	5.87,	'be',	'Belgium',	30528),
(18,	22806,	160,	347369,	1.87,	24.68,	5.97,	0,	'bh',	'Belize',	22966),
(19,	110622,	2000,	10448647,	2.78,	36.02,	8.21,	0,	'bn',	'Benin',	112622),
(20,	38394,	0,	741919,	1.11,	17.78,	6.69,	0,	'bt',	'Bhutan',	38394),
(21,	1083301,	15280,	10800882,	1.56,	22.76,	6.52,	0.62,	'bl',	'Bolivia',	1098581),
(22,	51187,	10,	3867055,	0.13,	8.87,	9.75,	0.38,	'bk',	'BosniaandHerzegovina',	51197),
(23,	566730,	15000,	2182719,	1.21,	20.96,	13.39,	4.56,	'bc',	'Botswana',	581730),
(24,	8358140,	157630,	204259812,	0.77,	14.46,	6.58,	0.14,	'br',	'Brazil',	8515770),
(25,	5265,	500,	429646,	1.62,	17.32,	3.52,	2.43,	'bx',	'Brunei',	5765),
(26,	108489,	2390,	7186893,	0.58,	8.92,	14.44,	0.29,	'bu',	'Bulgaria',	110879),
(27,	273800,	400,	18931686,	3.03,	42.03,	11.72,	0,	'uv',	'BurkinaFaso',	274200),
(28,	653508,	23070,	56320206,	1.01,	18.39,	7.96,	0.28,	'bm',	'Burma',	676578),
(29,	25680,	2150,	10742276,	3.28,	42.01,	9.27,	0,	'by',	'Burundi',	27830),
(30,	176515,	4520,	15708756,	1.58,	23.83,	7.68,	0.32,	'cb',	'Cambodia',	181035),
(31,	472710,	2730,	23739218,	2.59,	36.17,	10.11,	0.15,	'cm',	'Cameroon',	475440),
(32,	9093507,	891163,	35099836,	0.75,	10.28,	8.42,	5.66,	'ca',	'Canada',	9984670),
(33,	4033,	0,	545993,	1.36,	20.33,	6.11,	0.63,	'cv',	'CaboVerde',	4033),
(34,	622984,	0,	5391539,	2.13,	35.08,	13.8,	0,	'ct',	'CentralAfricanRepublic',	622984),
(35,	1259200,	24800,	11631456,	1.89,	36.6,	14.28,	3.45,	'cd',	'Chad',	0),
(36,	743812,	12290,	17508260,	0.82,	13.83,	6,	0.34,	'ci',	'Chile',	756102),
(37,	9326410,	270550,	1367485388,	0.45,	12.49,	7.53,	0.44,	'ch',	'China',	9596960),
(38,	1038700,	100210,	46736728,	1.04,	16.47,	5.4,	0.64,	'co',	'Colombia',	1138910),
(39,	2235,	0,	780971,	1.77,	27.84,	7.57,	2.53,	'cn',	'Comoros',	2235),
(40,	2267048,	77810,	79375136,	2.45,	34.88,	10.07,	0.27,	'cg',	'Congo_DemocraticRepublicofthe',	2344858),
(41,	341500,	500,	4755097,	2,	35.85,	10,	5.9,	'cf',	'Congo_Republicofthe',	342000),
(42,	51060,	40,	4814144,	1.22,	15.91,	4.55,	0.83,	'cs',	'CostaRica',	51100),
(43,	318003,	4460,	23295302,	1.91,	28.67,	9.55,	0,	'iv',	'Coted\'Ivoire',	322463),
(44,	55974,	620,	4464844,	0.13,	9.45,	12.18,	1.39,	'hr',	'Croatia',	56594),
(45,	109820,	1040,	11031433,	0.15,	9.9,	7.72,	3.66,	'cu',	'Cuba',	110860),
(46,	9241,	10,	1189197,	1.43,	11.41,	6.62,	9.48,	'cy',	'Cyprus',	9251),
(47,	77247,	1620,	10644842,	0.16,	9.63,	10.34,	2.33,	'ez',	'CzechRepublic',	78867),
(48,	42434,	660,	5581503,	0.22,	10.27,	10.25,	2.2,	'da',	'Denmark',	43094),
(49,	23180,	20,	828324,	2.2,	23.65,	7.73,	6.06,	'dj',	'Djibouti',	23200),
(50,	751,	0,	73607,	0.21,	15.41,	7.91,	5.38,	'do',	'Dominica',	751),
(51,	48320,	350,	10478756,	1.23,	18.73,	4.55,	1.91,	'dr',	'DominicanRepublic',	48670),
(52,	276841,	6720,	15868396,	1.35,	18.51,	5.06,	0,	'ec',	'Ecuador',	283561),
(53,	995450,	6000,	88487396,	1.79,	22.9,	4.77,	0.19,	'eg',	'Egypt',	1001450);

INSERT INTO worldfacts
(id, area_land, area_water, population, population_growth,
birth_rate, death_rate, migration_rate, city_code, city_name,city_area)
VALUES
(54,	20721,	320,	6141350,	0.25,	16.46,	5.69,	8.28,	'es',	'ElSalvador',	21041),
(55,	28051,	0,	740743,	2.51,	33.31,	8.19,	0,	'ek',	'EquatorialGuinea',	28051),
(56,	101000,	16600,	6527689,	2.25,	30,	7.52,	0,	'er',	'Eritrea',	117600),
(57,	42388,	2840,	1265420,	0.55,	10.51,	12.4,	3.6,	'en',	'Estonia',	45228),
(58,	0,	104300,	99465819,	2.89,	37.27,	8.19,	0.22,	'et',	'Ethiopia',	1104300),
(59,	18274,	0,	909389,	0.67,	19.43,	6.04,	6.75,	'fj',	'Fiji',	18274),
(60,	303815,	34330,	5476922,	0.4,	10.72,	9.83,	3.1,	'fi',	'Finland',	338145),
(61,	640427,	3374,	66553766,	0.43,	12.38,	9.16,	1.09,	'fr',	'France',	643801),
(62,	257667,	10000,	1705336,	1.93,	34.49,	13.12,	2.03,	'gb',	'Gabon',	267667),
(63,	10120,	1180,	1967709,	2.16,	30.86,	7.15,	2.12,	'ga',	'Gambia_The',	11300),
(64,	69700,	0,	4931226,	0.08,	12.74,	10.82,	2.7,	'gg',	'Georgia',	69700),
(65,	348672,	8350,	80854408,	0.17,	8.47,	11.42,	1.24,	'gm',	'Germany',	357022),
(66,	227533,	11000,	26327649,	2.18,	31.09,	7.22,	2.02,	'gh',	'Ghana',	238533),
(67,	130647,	1310,	10775643,	0.01,	8.66,	11.09,	2.32,	'gr',	'Greece',	131957),
(68,	344,	0,	110694,	0.48,	16.03,	8.08,	3.13,	'gj',	'Grenada',	344),
(69,	107159,	1730,	14918999,	1.82,	24.89,	4.77,	1.97,	'gt',	'Guatemala',	108889),
(70,	245717,	140,	11780162,	2.63,	35.74,	9.46,	0,	'gv',	'Guinea',	245857),
(71,	28120,	8005,	1726170,	1.91,	33.38,	14.33,	0,	'pu',	'Guinea-Bissau',	36125),
(72,	196849,	18120,	735222,	0.02,	15.59,	7.32,	8.06,	'gy',	'Guyana',	214969),
(73,	27560,	190,	10110019,	1.17,	22.31,	7.83,	2.76,	'ha',	'Haiti',	27750),
(74,	111890,	200,	8746673,	1.68,	23.14,	5.17,	1.16,	'ho',	'Honduras',	112090),
(75,	89608,	3420,	9897541,	0.22,	9.16,	12.73,	1.33,	'hu',	'Hungary',	93028),
(76,	100250,	2750,	331918,	1.21,	13.91,	6.28,	4.43,	'ic',	'Iceland',	103000),
(77,	2973193,	314070,	1251695584,	1.22,	19.55,	7.32,	0.04,	'in',	'India',	3287263),
(78,	1811569,	93000,	255993674,	0.92,	16.72,	6.37,	1.16,	'id',	'Indonesia',	1904569),
(79,	1531595,	116600,	81824270,	1.2,	17.99,	5.94,	0.07,	'ir',	'Iran',	1648195),
(80,	437367,	950,	37056169,	2.93,	31.45,	3.77,	1.62,	'iz',	'Iraq',	438317),
(81,	68883,	1390,	4892305,	1.25,	14.84,	6.48,	4.09,	'ei',	'Ireland',	70273),
(82,	20330,	440,	8049314,	1.56,	18.48,	5.15,	2.24,	'is',	'Israel',	20770),
(83,	294140,	7200,	61855120,	0.27,	8.74,	10.19,	4.1,	'it',	'Italy',	301340),
(84,	10831,	160,	2950210,	0.68,	18.16,	6.7,	4.66,	'jm',	'Jamaica',	10991),
(85,	364485,	13430,	126919659,	0.16,	7.93,	9.51,	0,	'ja',	'Japan',	377915),
(86,	88802,	540,	8117564,	0.83,	25.37,	3.79,	13.24,	'jo',	'Jordan',	89342),
(87,	2699700,	25200,	18157122,	1.14,	19.15,	8.21,	0.41,	'kz',	'Kazakhstan',	2724900),
(88,	569140,	11227,	45925301,	1.93,	26.4,	6.89,	0.22,	'ke',	'Kenya',	580367),
(89,	811,	0,	105711,	1.15,	21.46,	7.12,	2.87,	'kr',	'Kiribati',	811),
(90,	120408,	130,	24983205,	0.53,	14.52,	9.21,	0.04,	'kn',	'Korea_North',	120538),
(91,	96920,	2800,	49115196,	0.14,	8.19,	6.75,	0,	'ks',	'Korea_South',	99720),
(92,	10887,	0,	1870981,	0,	0,	0,	0,	'kv',	'Kosovo',	10887),
(93,	17818,	0,	2788534,	1.62,	19.91,	2.18,	1.58,	'ku',	'Kuwait',	17818),
(94,	191801,	8150,	5664939,	1.11,	22.98,	6.65,	5.22,	'kg',	'Kyrgyzstan',	199951),
(95,	230800,	6000,	6911544,	1.55,	24.25,	7.63,	1.09,	'la',	'Laos',	236800),
(96,	62249,	2340,	1986705,	1.06,	10,	14.31,	6.26,	'lg',	'Latvia',	64589),
(97,	10230,	170,	6184701,	0.86,	14.59,	4.88,	1.1,	'le',	'Lebanon',	10400),
(98,	30355,	0,	1947701,	0.32,	25.47,	14.89,	7.36,	'lt',	'Lesotho',	30355),
(99,	96320,	15049,	4195666,	2.47,	34.41,	9.69,	0,	'li',	'Liberia',	111369),
(100,	1759540,	0,	6411776,	2.23,	18.03,	3.58,	7.8,	'ly',	'Libya',	1759540),
(101,	160,	0,	37624,	0.84,	10.45,	7.12,	5.08,	'ls',	'Liechtenstein',	160),
(102,	62680,	2620,	2884433,	1.04,	10.1,	14.27,	6.27,	'lh',	'Lithuania',	65300),
(103,	2586,	0,	570252,	2.13,	11.37,	7.24,	17.16,	'lu',	'Luxembourg',	2586),
(104,	25433,	280,	2096015,	0.2,	11.55,	9.08,	0.48,	'mk',	'Macedonia',	25713),
(105,	581540,	5501,	23812681,	2.58,	32.61,	6.81,	0,	'ma',	'Madagascar',	587041),
(106,	94080,	24404,	17964697,	3.32,	41.56,	8.41,	0,	'mi',	'Malawi',	118484),
(107,	328657,	1190,	30513848,	1.44,	19.71,	5.03,	0.33,	'my',	'Malaysia',	329847),
(108,	298,	0,	393253,	0.08,	15.75,	3.89,	12.68,	'mv',	'Maldives',	298),
(109,	1220190,	20002,	16955536,	2.98,	44.99,	12.89,	2.26,	'ml',	'Mali',	1240192),
(110,	316,	0,	413965,	0.31,	10.18,	9.09,	1.98,	'mt',	'Malta',	316),
(111,	181,	0,	72191,	1.66,	25.6,	4.21,	4.83,	'rm',	'MarshallIslands',	181),
(112,	1030700,	0,	3596702,	2.23,	31.34,	8.2,	0.83,	'mr',	'Mauritania',	1030700),
(113,	2030,	10,	1339827,	0.64,	13.29,	6.91,	0,	'mp',	'Mauritius',	2040),
(114,	1943945,	20430,	121736809,	1.18,	18.78,	5.26,	1.68,	'mx',	'Mexico',	1964375),
(115,	702,	0,	105216,	0.46,	20.54,	4.23,	20.93,	'fm',	'Micronesia_FederatedStatesof',	702),
(116,	32891,	960,	3546847,	1.03,	12,	12.59,	9.67,	'md',	'Moldova',	33851),
(117,	2,	0,	30535,	0.12,	6.65,	9.24,	3.83,	'mn',	'Monaco',	2),
(118,	1553556,	10560,	2992908,	1.31,	20.25,	6.35,	0.84,	'mg',	'Mongolia',	1564116),
(119,	13452,	360,	647073,	0.42,	10.42,	9.43,	0,	'mj',	'Montenegro',	13812),
(120,	446300,	250,	33322699,	1,	18.2,	4.81,	3.36,	'mo',	'Morocco',	446550),
(121,	786380,	13000,	25303113,	2.45,	38.58,	12.1,	1.98,	'mz',	'Mozambique',	799380),
(122,	823290,	1002,	2212307,	0.59,	19.8,	13.91,	0,	'wa',	'Namibia',	824292),
(123,	21,	0,	9540,	0.55,	24.95,	5.87,	13.63,	'nr',	'Nauru',	21),
(124,	143351,	3830,	31551305,	1.79,	20.64,	6.56,	3.86,	'np',	'Nepal',	147181),
(125,	33893,	7650,	16947904,	0.41,	10.83,	8.66,	1.95,	'nl',	'Netherlands',	41543),
(126,	267710,	4438393,	0.82, 0, 13.33,	7.36,	2.21,	'nz',	'NewZealand',	267710),
(127,	119990,	10380,	5907881,	1,	18.03,	5.08,	3,	'nu',	'Nicaragua',	130370),
(128,	1266700,	300,	18045729,	3.25,	45.45,	12.42,	0.56,	'ng',	'Niger', 0),
(129,	910768,	13000,	181562056,	2.45,	37.64,	12.9,	0.22,	'ni',	'Nigeria',	923768),
(130,	304282,	19520,	5207689,	1.13,	12.14,	8.12,	7.25,	'no',	'Norway',	323802),
(131,	309500,	0,	3286936,	2.07,	24.44,	3.36,	0.43,	'mu',	'Oman',	309500),
(132,	770875,	25220,	199085847,	1.46,	22.58,	6.49,	1.54,	'pk',	'Pakistan',	796095),
(133,	459,	0,	21265,	0.38,	11.05,	7.99,	0.71,	'ps',	'Palau',	459),
(134,	74340,	1080,	3657024,	1.32,	18.32,	4.81,	0.28,	'pm',	'Panama',	75420),
(135,	452860,	9980,	6672429,	1.78,	24.38,	6.53,	0,	'pp',	'PapuaNewGuinea',	462840),
(136,	397302,	9450,	6783272,	1.16,	16.37,	4.68,	0.07,	'pa',	'Paraguay',	406752),
(137,	1279996,	5220,	30444999,	0.97,	18.28,	6.01,	2.53,	'pe',	'Peru',	1285216),
(138,	298170,	1830,	100998376,	1.61,	24.27,	6.11,	2.09,	'rp',	'Philippines',	300000),
(139,	304255,	8430,	38562189,	0.09,	9.74,	10.19,	0.46,	'pl',	'Poland',	312685),
(140,	91470,	620,	10825309,	0.09,	9.27,	11.02,	2.67,	'po',	'Portugal',	92090),
(141,	11586,	0,	2194817,	3.07,	9.84,	1.53,	22.39,	'qa',	'Qatar',	11586),
(142,	229891,	8500,	21666350,	0.3,	9.14,	11.9,	0.24,	'ro',	'Romania',	238391),
(143,	16377742,	720500,	142423773,	0.04,	11.6,	13.69,	1.69,	'rs',	'Russia',	17098242),
(144,	24668,	1670,	12661733,	2.56,	33.75,	8.96,	0.85,	'rw',	'Rwanda',	26338),
(145,	261,	0,	51936,	0.76,	13.5,	7.09,	1.21,	'sc',	'SaintKittsandNevis',	261),
(146,	606,	10,	163922,	0.34,	13.7,	7.42,	2.93,	'st',	'SaintLucia',	616),
(147,	389,	0,	102627,	0.28,	13.57,	7.18,	9.17,	'vc',	'SaintVincentandtheGrenadines',	389),
(148,	2821,	10,	197773,	0.58,	20.87,	5.32,	9.78,	'ws',	'Samoa',	2831),
(149,	61,	0,	33020,	0.82,	8.63,	8.45,	8.03,	'sm',	'SanMarino',	61),
(150,	964,	0,	194006,	1.84,	34.23,	7.24,	8.63,	'tp',	'SaoTomeandPrincipe',	964),
(151,	2149690,	0,	27752316,	1.46,	18.51,	3.33,	0.55,	'sa',	'SaudiArabia',	2149690),
(152,	192530,	4192,	13975834,	2.45,	34.52,	8.46,	1.59,	'sg',	'Senegal',	196722),
(153,	77474,	0,	7176794,	0.46,	9.08,	13.66,	0,	'ri',	'Serbia',	77474),
(154,	455,	0,	92430,	0.83,	14.19,	6.89,	1,	'se',	'Seychelles',	455),
(155,	71620,	120,	5879098,	2.35,	37.03,	10.81,	2.77,	'sl',	'SierraLeone',	71740),
(156,	687,	10,	5674472,	1.89,	8.27,	3.43,	14.05,	'sn',	'Singapore',	697),
(157,	48105,	930,	5445027,	0.02,	9.91,	9.74,	0.04,	'lo',	'Slovakia',	49035),
(158,	20151,	122,	1983412,	0.26,	8.42,	11.37,	0.37,	'si',	'Slovenia',	20273),
(159,	27986,	910,	622469,	2.02,	25.77,	3.85,	1.75,	'bp',	'SolomonIslands',	28896),
(160,	627337,	10320,	10616380,	1.83,	40.45,	13.62,	8.49,	'so',	'Somalia',	637657),
(161,	1214470,	4620,	53675563,	1.33,	20.75,	9.91,	2.42,	'sf',	'SouthAfrica',	1219090),
(162,	0,	0,	12042910,	4.02,	36.91,	8.18,	11.47,	'od',	'SouthSudan',	644329),
(163,	498980,	6390,	48146134,	0.89,	9.64,	9.04,	8.31,	'sp',	'Spain',	505370),
(164,	64630,	980,	22053488,	0.84,	15.85,	6.11,	1.35,	'ce',	'SriLanka',	65610),
(165,	0,	0,	36108853,	1.72,	29.19,	7.66,	4.29,	'su',	'Sudan',	1861484),
(166,	156000,	7820,	579633,	1.08,	16.34,	6.13,	0.56,	'ns',	'Suriname',	163820),
(167,	17204,	160,	1435613,	1.11,	24.67,	13.56,	0,	'wz',	'Swaziland',	17364),
(168,	410335,	39960,	9801616,	0.8,	11.99,	9.4,	5.42,	'sw',	'Sweden',	450295),
(169,	39997,	1280,	8121830,	0.71,	10.5,	8.13,	4.74,	'sz',	'Switzerland',	41277),
(170,	183630,	1550,	17064854,	0.16,	22.17,	4,	19.79,	'sy',	'Syria',	185180),
(171,	141510,	2590,	8191958,	1.71,	24.38,	6.18,	1.15,	'ti',	'Tajikistan',	144100),
(172,	885800,	61500,	51045882,	2.79,	36.39,	8,	0.54,	'tz',	'Tanzania',	947300),
(173,	510890,	2230,	67976405,	0.34,	11.19,	7.8,	0,	'th',	'Thailand',	513120),
(174,	14874,	0,	1231116,	2.42,	34.16,	6.1,	3.86,	'tt',	'Timor-Leste',	14874),
(175,	54385,	2400,	7552318,	2.69,	34.13,	7.26,	0,	'to',	'Togo',	56785),
(176,	717,	30,	106501,	0.03,	23,	4.85,	17.84,	'tn',	'Tonga',	747),
(177,	5128,	0,	1222363,	0.13,	13.46,	8.56,	6.25,	'td',	'TrinidadandTobago',	5128),
(178,	155360,	8250,	11037225,	0.89,	16.64,	5.98,	1.73,	'ts',	'Tunisia',	163610),
(179,	769632,	13930,	79414269,	1.26,	16.33,	5.88,	2.16,	'tu',	'Turkey',	783562),
(180,	469930,	18170,	5231422,	1.14,	19.4,	6.13,	1.84,	'tx',	'Turkmenistan',	488100),
(181,	26,	0,	10869,	0.82,	23.74,	8.74,	6.81,	'tv',	'Tuvalu',	26),
(182,	197100,	43938,	37101745,	3.24,	43.79,	10.69,	0.74,	'ug',	'Uganda',	241038),
(183,	579330,	24220,	44429471,	0.6,	10.72,	14.46,	2.25,	'up',	'Ukraine',	603550),
(184,	83600,	0,	5779760,	2.58,	15.43,	1.97,	12.36,	'ae',	'UnitedArabEmirates',	83600),
(185,	241930,	1680,	64088222,	0.54,	12.17,	9.35,	2.54,	'uk',	'UnitedKingdom',	243610),
(186,	9161966,	664709,	321368864,	0.78,	12.49,	8.15,	3.86,	'us',	'UnitedStates',	9826675),
(187,	175015,	1200,	3341893,	0.27,	13.07,	9.45,	0.9,	'uy',	'Uruguay',	176215),
(188,	425400,	22000,	29199942,	0.93,	17,	5.3,	2.37,	'uz',	'Uzbekistan',	447400),
(189,	12189,	0,	272264,	1.95,	25.04,	4.09,	1.47,	'nh',	'Vanuatu',	12189),
(190,	0,	0,	842,	0,	19.16,	5.31,	5.31,	'vt',	'HolySee(VaticanCity)',	0),
(191,	882050,	30000,	29275460,	1.39,	19.16,	5.31,	0,	've',	'Venezuela',	912050),
(192,	310070,	21140,	94348835,	0.97,	15.96,	5.93,	0.3,	'vm',	'Vietnam',	331210),
(193,	527968,	0,	26737317,	2.47,	29.98,	6.28,	1,	'ym',	'Yemen',	527968),
(194,	743398,	9220,	15066266,	2.88,	42.13,	12.67,	0.68,	'za',	'Zambia',	752618),
(195,	386847,	3910,	14229541,	2.21,	32.26,	10.13,	0,	'zi',	'Zimbabwe',	390757),
(196,	32260,	3720,	23415126,	0.23,	8.47,	7.11,	0.89,	'tw',	'Taiwan',	35980),
(197,	32260,	0,	513949445,	0.25,	10.2,	10.2,	2.5,	'ee',	'EuropeanUnion',	4324782),
(199,	135,	0,	1530,	1.11,	0,	0,	0,	'kt',	'ChristmasIsland',	135),
(200,	14,	0,	596,	0,	0,	0,	0,	'ck',	'Cocos(Keeling)Islands',	14),
(203,	36,	0,	2210,	0.01,	0,	0,	0,	'nf',	'NorfolkIsland',	36),
(204,	1073,	35,	7141106,	0.38,	9.23,	7.07,	1.68,	'hk',	'HongKong',	1108),
(205,	28,	0,	592731,	0.8,	8.88,	4.22,	3.37,	'mc',	'Macau',	28),
(206,	1393,	0,	50196,	0.51,	13.77,	8.71,	0,	'fo',	'FaroeIslands',	1393),
(207,	2166086,	0,	57733,	0,	14.48,	8.49,	5.98,	'gl',	'Greenland',	2166086),
(211,	18275,	300,	271615,	1.38,	15.33,	5.52,	4.01,	'nc',	'NewCaledonia',	18575),
(215,	142,	0,	15613,	0.33,	13.45,	5.06,	5.06,	'wf',	'WallisandFutuna',	142),
(218,	34,	0,	39689,	1.51,	13,	4.51,	6.63,	'sk',	'SintMaarten',	34),
(219,	236,	0,	9838,	2.95,	14.33,	8.03,	0,	'cw',	'CookIslands',	236),
(220,	260,	0,	1190,	0.03,	0,	0,	0,	'ne',	'Niue',	260),
(221,	12,	0,	1337,	0.01,	0,	0,	0,	'tl',	'Tokelau',	12),
(224,	62045,	0,	1872,	0.03,	0,	0,	0,	'sv',	'Svalbard',	62045),
(226,	91,	0,	16418,	2.03,	12.67,	4.57,	12.18,	'av',	'Anguilla',	91),
(227,	54,	0,	70196,	0.5,	11.33,	8.23,	1.88,	'bd',	'Bermuda',	54),
(229,	151,	0,	33454,	2.32,	10.91,	4.99,	17.28,	'vi',	'BritishVirginIslands',	151),
(230,	264,	0,	56092,	2.1,	12.11,	5.53,	14.4,	'cj',	'CaymanIslands',	264),
(232,	12173,	0,	3361,	0.01,	10.9,	4.9,	0,	'fk',	'FalklandIslands(IslasMalvinas)',	12173),
(233,	6,	0,	29258,	0.24,	14.08,	8.37,	3.28,	'gi',	'Gibraltar',	6),
(234,	78,	0,	66080,	0.34,	9.84,	8.78,	2.32,	'gk',	'Guernsey',	78),
(235,	116,	0,	97294,	0.8,	11.91,	7.68,	3.76,	'je',	'Jersey',	116),
(236,	572,	0,	87545,	0.76,	11.1,	10.06,	6.56,	'im',	'IsleofMan',	572),
(237,	102,	0,	5241,	0.5,	11.26,	6.3,	0,	'mh',	'Montserrat',	102),
(238,	47,	0,	48,	0,	0,	0,	0,	'pc',	'PitcairnIslands',	47),
(239,	122,	0,	7795,	0.24,	9.88,	7.44,	0,	'sh',	'SaintHelena_Ascension_andTristandaCunha',	308),
(241,	948,	0,	50280,	2.3,	16.13,	3.1,	9.94,	'tk',	'TurksandCaicosIslands',	948),
(242,	199,	0,	54343,	0.3,	22.89,	4.75,	21.13,	'aq',	'AmericanSamoa',	199),
(243,	544,	0,	161785,	0.54,	16.82,	5.12,	6.34,	'gq',	'Guam',	544),
(245,	464,	0,	52344,	2.18,	18.32,	3.71,	7.16,	'cq',	'NorthernMarianaIslands',	464),
(246,	8870,	4921,	3598357,	0.6,	10.86,	8.67,	8.15,	'rq',	'PuertoRico',	13791),
(247,	346,	1564,	103574,	0.59,	10.31,	8.54,	7.67,	'vq',	'VirginIslands',	1910),
(251,	360,	0,	1869055,	2.81,	31.11,	3.04,	0,	'gz',	'GazaStrip',	360),
(252,	7,	2390,	2785366,	1.95,	22.99,	3.5,	0,	'pf',	'ParacelIslands',	7),
(253,	5,	400,	2785366,	1.95,	22.99,	3.5,	0,	'pg',	'SpratlyIslands',	5),
(254,	5640,	220,	2785366,	1.95,	22.99,	3.5,	0,	'we',	'WestBank',	5860),
(255,	266000,	157630,	570866,	2.82,	30.24,	8.34,	0.62,	'wi',	'WesternSahara',	266000),
(256,	266001,	500,	570867,	2.82,	30.24,	8.34,	0.38,	'xq',	'ArcticOcean',	0),
(257,	266002,	2390,	570868,	2.82,	30.24,	8.34,	4.56,	'zh',	'AtlanticOcean',	0),
(258,	266003,	400,	570869,	2.82,	30.24,	8.34,	0.14,	'xo',	'IndianOcean',	0),
(259,	266004,	23070,	570870,	2.82,	30.24,	8.34,	2.43,	'zn',	'PacificOcean',	0),
(260,	266005,	2150,	570871,	2.82,	30.24,	8.34,	0.29,	'oo',	'SouthernOcean',	0),
(261,	266006,	4520,	570872,	1.08,	18.6,	7.8,	0.29,	'xx',	'World',	0);

SELECT * FROM worldfacts
LIMIT 10;
-- now that we have the database ready, we can now explore by creating the summary statistics 
SELECT MIN(population) AS min_pop,
       MAX(population) AS max_pop,
       MIN(population_growth) AS min_pop_growth,
       MAX(population_growth) max_pop_growth 
FROM worldfacts;  
-- Result:
-- There's a country with a population of 48.
-- There's a country with a population of 1367485388.
-- let us explore some of these countries

SELECT *
FROM worldfacts
WHERE population = (SELECT MIN(population) 
FROM worldfacts);
-- Result: PitcairnIslands is the lowest populated country.

-- Let us identify the country with the highest population
SELECT *
FROM worldfacts
WHERE population = (SELECT MAX(population)
FROM worldfacts);		 
-- Result: China is the highest populated country.

-- AVERAGE POPULATION DENSITY: Population density depends on the population and country area. 
-- Tells us how densely populated a country is based on the population and country space/area
SELECT AVG(population) AS avg_population, AVG(city_area) AS avg_area
FROM worldfacts;
-- Result:  The average population is around 32 million and the average area is 578 thousand square kilometers.

-- Also, we want to find countries that are densely populated. We will identify countries that have the following:
-- Above-average values for population.
-- Below-average values for area.

SELECT *
FROM worldfacts
WHERE population > (SELECT AVG(population) FROM worldfacts)
AND city_area < (SELECT AVG(city_area) FROM worldfacts);

-- TABLE 2: WORLD CRIME INDEX                 
-- Now we want to create another table that shows WORLD CRIME INDEX in each country using country id as primary key
CREATE TABLE worldcrime(
    id INTEGER NOT NULL,
    city_code varchar(255) NOT NULL, 
    city_name varchar(255) NOT NULL, 
    crime_index float, 
    PRIMARY KEY (id)
); 
INSERT INTO worldcrime
(id, city_code, city_name, crime_index)
VALUES
(1,	'af',	'Afghanistan',	83.98),
(2,	'al',	'Albania',	81.98),
(3,	'ag',	'Algeria',	61.8),
(4,	'an',	'Andorra',	40.87),
(5,	'ao',	'Angola',	80.71),
(6,	'ac',	'AntiguaandBarbuda',	80.6),
(7,	'ar',	'Argentina',	30.55),
(8,	'am',	'Armenia',	79.39),
(9,	'as',	'Australia',	77.93),
(10,	'au',	'Austria',	77.69),
(11,	'aj',	'Azerbaijan',	77.36),
(12,	'bf',	'Bahamas_The',	76.44),
(13,	'ba',	'Bahrain',	76.42),
(14,	'bg',	'Bangladesh',	76.21),
(15,	'bb',	'Barbados',	75.75),
(16,	'bo',	'Belarus',	75.69),
(17,	'be',	'Belgium',	75.11),
(18,	'bh',	'Belize',	74.76),
(19,	'bn',	'Benin',	74.63),
(20,	'bt',	'Bhutan',	73.51),
(21,	'bl',	'Bolivia',	73.13),
(22,	'bk',	'BosniaandHerzegovina',	72.92),
(23,	'bc',	'Botswana',	71.87),
(24,	'br',	'Brazil',	71.44),
(25,	'bx',	'Brunei',	71.32),
(26,	'bu',	'Bulgaria',	71.24),
(27,	'uv',	'BurkinaFaso',	70.93),
(28,	'bm',	'Burma',	70.7),
(29,	'by',	'Burundi',	70.59),
(30,	'cb',	'Cambodia',	70.49),
(31,	'cm',	'Cameroon',	70.46),
(32,	'ca',	'Canada',	69.79),
(33,	'cv',	'CaboVerde',	69.5),
(34,	'ct',	'CentralAfricanRepublic',	68.86),
(35,	'cd',	'Chad',	68.64),
(36,	'ci',	'Chile',	68.55),
(37,	'ch',	'China',	68.37),
(38,	'co',	'Colombia',	68.35),
(39,	'cn',	'Comoros',	67.94),
(40,	'cg',	'Congo_DemocraticRepublicofthe',	67.45),
(41,	'cf',	'Congo_Republicofthe',	67.05),
(42,	'cs',	'CostaRica',	66.78),
(43,	'iv',	'Coted\'Ivoire',	66.74),
(44,	'hr',	'Croatia',	66.54),
(45,	'cu',	'Cuba',	66.22),
(46,	'cy',	'Cyprus',	66.1),
(47,	'ez',	'CzechRepublic',	65.7),
(48,	'da',	'Denmark',	65.42),
(49,	'dj',	'Djibouti',	64.72),
(50,	'do',	'Dominica',	64.58),
(51,	'dr',	'DominicanRepublic',	64.39),
(52,	'ec',	'Ecuador',	64.32),
(53,	'eg',	'Egypt',	64.17),
(54,	'es',	'ElSalvador',	63.89),
(55,	'ek',	'EquatorialGuinea',	63.89),
(56,	'er',	'Eritrea',	63.66),
(57,	'en',	'Estonia',	63.65),
(58,	'et',	'Ethiopia',	63.54),
(59,	'fj',	'Fiji',	63.51),
(60,	'fi',	'Finland',	63.4),
(61,	'fr',	'France',	63.33),
(62,	'gb',	'Gabon',	62.84),
(63,	'ga',	'Gambia_The',	62.77),
(64,	'gg',	'Georgia',	62.68),
(65,	'gm',	'Germany',	62.65),
(66,	'gh',	'Ghana',	62.51),
(67,	'gr',	'Greece',	62.29),
(68,	'gj',	'Grenada',	62.27),
(69,	'gt',	'Guatemala',	62.19),
(70,	'gv',	'Guinea',	61.99),
(71,	'pu',	'Guinea-Bissau',	61.75),
(72,	'gy',	'Guyana',	61.56),
(73,	'ha',	'Haiti',	60.99),
(74,	'ho',	'Honduras',	60.92),
(75,	'hu',	'Hungary',	60.58),
(76,	'ic',	'Iceland',	60.57),
(77,	'in',	'India',	60.38),
(78,	'id',	'Indonesia',	60.35),
(79,	'ir',	'Iran',	70.2),
(80,	'iz',	'Iraq',	80.1),
(81,	'ei',	'Ireland',	30.1),
(82,	'is',	'Israel',	59.96),
(83,	'it',	'Italy',	59.9),
(84,	'jm',	'Jamaica',	59.83),
(85,	'ja',	'Japan',	59.81),
(86,	'jo',	'Jordan',	59.8),
(87,	'kz',	'Kazakhstan',	79.46),
(88,	'ke',	'Kenya',	59.43),
(89,	'kr',	'Kiribati',	59.43),
(90,	'kn',	'Korea_North',	59.15),
(91,	'ks',	'Korea_South',	59.13),
(92,	'kv',	'Kosovo',	59.03),
(93,	'ku',	'Kuwait',	58.93),
(94,	'kg',	'Kyrgyzstan',	58.72),
(95,	'la',	'Laos',	58.47),
(96,	'lg',	'Latvia',	57.66),
(97,	'le',	'Lebanon',	57.41),
(98,	'lt',	'Lesotho',	57.38),
(99,	'li',	'Liberia',	57.12),
(100,	'ly',	'Libya',	60.82),
(101,	'ls',	'Liechtenstein',	56.59),
(102,	'lh',	'Lithuania',	56.42),
(103,	'lu',	'Luxembourg',	56.06),
(104,	'mk',	'Macedonia',	56.02),
(105,	'ma',	'Madagascar',	55.81),
(106,	'mi',	'Malawi',	55.76),
(107,	'my',	'Malaysia',	55.72),
(108,	'mv',	'Maldives',	55.67),
(109,	'ml',	'Mali',	55.39),
(110,	'mt',	'Malta',	55.38),
(111,	'rm',	'MarshallIslands',	55.34),
(112,	'mr',	'Mauritania',	55.18),
(113,	'mp',	'Mauritius',	55.16),
(114,	'mx',	'Mexico',	55.1),
(115,	'fm',	'Micronesia_FederatedStatesof',	55.09),
(116,	'md',	'Moldova',	55.08),
(117,	'mn',	'Monaco',	55.06),
(118,	'mg',	'Mongolia',	55.05),
(119,	'mj',	'Montenegro',	54.98),
(120,	'mo',	'Morocco',	54.89),
(121,	'mz',	'Mozambique',	54.81),
(122,	'wa',	'Namibia',	54.81),
(123,	'nr',	'Nauru',	54.8),
(124,	'np',	'Nepal',	54.53),
(125,	'nl',	'Netherlands',	54.42),
(126,	'nz',	'NewZealand',	54.33),
(127,	'nu',	'Nicaragua',	54.2),
(128,	'ng',	'Niger',	54.1),
(129,	'ni',	'Nigeria',	54.07),
(130,	'no',	'Norway',	53.88),
(131,	'mu',	'Oman',	53.61),
(132,	'pk',	'Pakistan',	53.59),
(133,	'ps',	'Palau',	53.56),
(134,	'pm',	'Panama',	53.3),
(135,	'pp',	'PapuaNewGuinea',	53.29),
(136,	'pa',	'Paraguay',	53.17),
(137,	'pe',	'Peru',	53.17),
(138,	'rp',	'Philippines',	53.12),
(139,	'pl',	'Poland',	53.11),
(140,	'po',	'Portugal',	53),
(141,	'qa',	'Qatar',	52.99),
(142,	'ro',	'Romania',	52.98),
(143,	'rs',	'Russia',	80.96),
(144,	'rw',	'Rwanda',	52.85),
(145,	'sc',	'SaintKittsandNevis',	52.82),
(146,	'st',	'SaintLucia',	52.63),
(147,	'vc',	'SaintVincentandtheGrenadines',	52.41),
(148,	'ws',	'Samoa',	52.31),
(149,	'sm',	'SanMarino',	52.3),
(150,	'tp',	'SaoTomeandPrincipe',	52.28),
(151,	'sa',	'SaudiArabia',	70.23),
(152,	'sg',	'Senegal',	52.15),
(153,	'ri',	'Serbia',	51.91),
(154,	'se',	'Seychelles',	51.88),
(155,	'sl',	'SierraLeone',	51.73),
(156,	'sn',	'Singapore',	51.49),
(157,	'lo',	'Slovakia',	51.41),
(158,	'si',	'Slovenia',	51.4),
(159,	'bp',	'SolomonIslands',	51.35),
(160,	'so',	'Somalia',	51.35),
(161,	'sf',	'SouthAfrica',	51.29),
(162,	'od',	'SouthSudan',	51.28),
(163,	'sp',	'Spain',	51.16),
(164,	'ce',	'SriLanka',	50.82),
(165,	'su',	'Sudan',	50.64),
(166,	'ns',	'Suriname',	50.29),
(167,	'wz',	'Swaziland',	49.68),
(168,	'sw',	'Sweden',	49.45),
(169,	'sz',	'Switzerland',	49.32),
(170,	'sy',	'Syria',	49.29),
(171,	'ti',	'Tajikistan',	49.23),
(172,	'tz',	'Tanzania',	48.92),
(173,	'th',	'Thailand',	48.87),
(174,	'tt',	'Timor-Leste',	48.85),
(175,	'to',	'Togo',	48.81),
(176,	'tn',	'Tonga',	48.65),
(177,	'td',	'TrinidadandTobago',	48.63),
(178,	'ts',	'Tunisia',	48.61),
(179,	'tu',	'Turkey',	48.6),
(180,	'tx',	'Turkmenistan',	48.57),
(181,	'tv',	'Tuvalu',	48.41),
(182,	'ug',	'Uganda',	48.39),
(183,	'up',	'Ukraine',	90.37),
(184,	'ae',	'UnitedArabEmirates',	48.36),
(185,	'uk',	'UnitedKingdom',	48.24),
(186,	'us',	'UnitedStates',	48.13),
(187,	'uy',	'Uruguay',	47.77),
(188,	'uz',	'Uzbekistan',	47.62),
(189,	'nh',	'Vanuatu',	47.55),
(190,	'vt',	'HolySee(VaticanCity)',	47.42),
(191,	've',	'Venezuela',	47.34),
(192,	'vm',	'Vietnam',	47.2),
(193,	'ym',	'Yemen',	47.2),
(194,	'za',	'Zambia',	47.16),
(195,	'zi',	'Zimbabwe',	47.15),
(196,	'tw',	'Taiwan',	47.14),
(197,	'ee',	'EuropeanUnion',	47.13),
(199,	'kt',	'ChristmasIsland',	46.99),
(200,	'ck',	'Cocos(Keeling)Islands',	46.92),
(203,	'nf',	'NorfolkIsland',	46.88),
(204,	'hk',	'HongKong',	46.84),
(205,	'mc',	'Macau',	46.84),
(206,	'fo',	'FaroeIslands',	46.76),
(207,	'gl',	'Greenland',	46.76),
(211,	'nc',	'NewCaledonia',	46.75),
(215,	'wf',	'WallisandFutuna',	46.68),
(218,	'sk',	'SintMaarten',	46.67),
(219,	'cw',	'CookIslands',	46.62),
(220,	'ne',	'Niue',	46.6),
(221,	'tl',	'Tokelau',	46.59),
(224,	'sv',	'Svalbard',	46.57),
(226,	'av',	'Anguilla',	46.45),
(227,	'bd',	'Bermuda',	46.45),
(229,	'vi',	'BritishVirginIslands',	46.24),
(230,	'cj',	'CaymanIslands',	46.19),
(232,	'fk',	'FalklandIslands(IslasMalvinas)',	45.97),
(233,	'gi',	'Gibraltar',	45.93),
(234,	'gk',	'Guernsey',	45.9),
(235,	'je',	'Jersey',	45.77),
(236,	'im',	'IsleofMan',	45.72),
(237,	'mh',	'Montserrat',	45.69),
(238,	'pc',	'PitcairnIslands',	45.45),
(239,	'sh',	'SaintHelena_Ascension_andTristandaCunha',	45.28),
(241,	'tk',	'TurksandCaicosIslands',	45.21),
(242,	'aq',	'AmericanSamoa',	45.04),
(243,	'gq',	'Guam',	44.9),
(245,	'cq',	'NorthernMarianaIslands',	44.87),
(246,	'rq',	'PuertoRico',	44.74),
(247,	'vq',	'VirginIslands',	44.56),
(251,	'gz',	'GazaStrip',	44.5),
(252,	'pf',	'ParacelIslands',	44.39),
(253,	'pg',	'SpratlyIslands',	44.12),
(254,	'we',	'WestBank',	44.06),
(255,	'wi',	'WesternSahara',	43.98),
(256,	'xq',	'ArcticOcean',	43.87),
(257,	'zh',	'AtlanticOcean',	43.86),
(258,	'xo',	'IndianOcean',	43.46),
(259,	'zn',	'PacificOcean',	43.34),
(260,	'oo',	'SouthernOcean',	43.25);

-- Let's see what our table looks like printing out some rows
SELECT * FROM worldcrime
LIMIT 10;
-- First thing we want to do is the summary statistics:
SELECT MIN(crime_index) AS min_danger,
       MAX(crime_index) AS max_danger,
       AVG(crime_index) AS avg_crime
FROM worldcrime;

-- Our report shows that the least dangerous country has a min crime index of 30.1 while
-- the most dangerous has a crime index of 90.37
-- Also, the average crime tells us the average country to live in has a crime index of 56.98
-- So, using this let us categorize our countries into 2 categories:
-- LEAST DANGEROUS COUNTRIES
SELECT *
FROM worldcrime
WHERE crime_index <= 56.98;
-- MOST DANGEROUS COUNTRIES
SELECT *
FROM worldcrime
WHERE crime_index > 56.98;

-- TABLE 3: WORLD GDP
-- Now we want to create another table that shows world GDP in each country using country id as primary key
CREATE TABLE worldgdp(
    id INTEGER NOT NULL,
    city_code varchar(255) NOT NULL, 
    city_name varchar(255) NOT NULL, 
    gdp float, 
    PRIMARY KEY (id) 
); 
INSERT INTO worldgdp
(id, city_code, city_name, gdp)
VALUES
(1,	'af',	'Afghanistan',	54.725),
(2,	'al',	'Albania',	18.012),
(3,	'ag',	'Algeria',	168.195),
(4,	'an',	'Andorra',	3.46),
(5,	'ao',	'Angola',	74.953),
(6,	'ac',	'AntiguaandBarbuda',	19.917),
(7,	'ar',	'Argentina',	483.765),
(8,	'am',	'Armenia',	15.06),
(9,	'as',	'Australia',	1677.451),
(10, 'au',	'Austria',	520.343),
(11,	'aj',	'Azerbaijan',	54.725),
(12,	'bf',	'Bahamas_The',	70.632),
(13,	'ba',	'Bahrain',	41.057),
(14,	'bg',	'Bangladesh',	390.608),
(15,	'bb',	'Barbados',	5.142),
(16,	'bo',	'Belarus',	70.632),
(17,	'be',	'Belgium',	619.16),
(18,	'bh',	'Belize',	2.062),
(19,	'bn',	'Benin',	19.917),
(20,	'bt',	'Bhutan',	2.74),
(21,	'bl',	'Bolivia',	40.895),
(22,	'bk',	'BosniaandHerzegovina',	40.895),
(23,	'bc',	'Botswana',	19.002),
(24,	'br',	'Brazil',	1810.612),
(25,	'bx',	'Brunei',	40.895),
(26,	'bu',	'Bulgaria',	84.308),
(27,	'uv',	'BurkinaFaso',	40.895),
(28,	'bm',	'Burma',	40.895),
(29,	'by',	'Burundi',	3.396),
(30,	'cb',	'Cambodia',	27.985),
(31,	'cm',	'Cameroon',	48.29),
(32,	'ca',	'Canada',	2189.786),
(33,	'cv',	'CaboVerde',	40.895),
(34,	'ct',	'CentralAfricanRepublic',	40.895),
(35,	'cd',	'Chad',	12.953),
(36,	'ci',	'Chile',	352.664),
(37,	'ch',	'China',	18463.13),
(38,	'co',	'Colombia',	319.29),
(39,	'cn',	'Comoros',	1.363),
(40,	'cg',	'Congo_DemocraticRepublicofthe',	40.895),
(41,	'cf',	'Congo_Republicofthe',	40.895),
(42,	'cs',	'CostaRica',	40.895),
(43,	'iv',	'Coted\'Ivoire',	40.895),
(44,	'hr',	'Croatia',	68.525),
(45,	'cu',	'Cuba',	40.895),
(46,	'cy',	'Cyprus',	28.291),
(47,	'ez',	'CzechRepublic',	40.895),
(48,	'da',	'Denmark',	414.55),
(49,	'dj',	'Djibouti',	3.932),
(50,	'do',	'Dominica',	0.628),
(51,	'dr',	'DominicanRepublic',	40.895),
(52,	'ec',	'Ecuador',	109.975),
(53,	'eg',	'Egypt',	438.348),
(54,	'es',	'ElSalvador',	40.895),
(55,	'ek',	'EquatorialGuinea',	40.895),
(56,	'er',	'Eritrea',	2.484),
(57,	'en',	'Estonia',	39.542),
(58,	'et',	'Ethiopia',	40.895),
(59,	'fj',	'Fiji',	5.01),
(60,	'fi',	'Finland',	314.538),
(61,	'fr',	'France',	3140.031),
(62,	'gb',	'Gabon',	19.632),
(63,	'ga',	'Gambia_The',	40.895),
(64,	'gg',	'Georgia',	19.688),
(65,	'gm',	'Germany',	4557.35),
(66,	'gh',	'Ghana',	82.018),
(67,	'gr',	'Greece',	224.894),
(68,	'gj',	'Grenada',	1.16),
(69,	'gt',	'Guatemala',	89.214),
(70,	'gv',	'Guinea',	18.223),
(71,	'pu',	'Guinea-Bissau',	1.721),
(72,	'gy',	'Guyana',	9.837),
(73,	'ha',	'Haiti',	18.825),
(74,	'ho',	'Honduras',	27.923),
(75,	'hu',	'Hungary',	198.992),
(76,	'ic',	'Iceland',	27.172),
(77,	'in',	'India',	3250.078),
(78,	'id',	'Indonesia',	1247.352),
(79,	'ir',	'Iran',	1136.683),
(80,	'iz',	'Iraq',	226.62),
(81,	'ei',	'Ireland',	550.518),
(82,	'is',	'Israel',	501.409),
(83,	'it',	'Italy',	2272.269),
(84,	'jm',	'Jamaica',	15.63),
(85,	'ja',	'Japan',	5383.682),
(86,	'jo',	'Jordan',	47.5),
(87,	'kz',	'Kazakhstan',	203.666),
(88,	'ke',	'Kenya',	116.641),
(89,	'kr',	'Kiribati',	0.245),
(90,	'kn',	'Korea_North',	40.895),
(91,	'ks',	'Korea_South',	40.895),
(92,	'kv',	'Kosovo',	9.752),
(93,	'ku',	'Kuwait',	138.78),
(94,	'kg',	'Kyrgyzstan',	8.928),
(95,	'la',	'Laos',	20.631),
(96,	'lg',	'Latvia',	40.83),
(97,	'le',	'Lebanon',	40.895),
(98,	'lt',	'Lesotho',	2.592),
(99,	'li',	'Liberia',	3.664),
(100,	'ly',	'Libya',	29.202),
(101,	'ls',	'Liechtenstein',	40.895),
(102,	'lh',	'Lithuania',	67.659),
(103,	'lu',	'Luxembourg',	89.683),
(104,	'mk',	'Macedonia',	40.895),
(105,	'ma',	'Madagascar',	15.402),
(106,	'mi',	'Malawi',	12.008),
(107,	'my',	'Malaysia',	415.375),
(108,	'mv',	'Maldives',	5.296),
(109,	'ml',	'Mali',	21.261),
(110,	'mt',	'Malta',	18.209),
(111,	'rm',	'MarshallIslands',	40.895),
(112,	'mr',	'Mauritania',	9.336),
(113,	'mp',	'Mauritius',	11.954),
(114,	'mx',	'Mexico',	1371.635),
(115,	'fm',	'Micronesia_FederatedStatesof',	40.895),
(116,	'md',	'Moldova',	13.315),
(117,	'mn',	'Monaco',	40.895),
(118,	'mg',	'Mongolia',	15.83),
(119,	'mj',	'Montenegro',	6.042),
(120,	'mo',	'Morocco',	132.645),
(121,	'mz',	'Mozambique',	16.759),
(122,	'wa',	'Namibia',	13.122),
(123,	'nr',	'Nauru',	0.139),
(124,	'np',	'Nepal',	36.296),
(125,	'nl',	'Netherlands',	1070.754),
(126,	'nz',	'NewZealand',	40.895),
(127,	'nu',	'Nicaragua',	13.948),
(128,	'ng',	'Niger',	17.261),
(129,	'ni',	'Nigeria',	555.346),
(130,	'no',	'Norway',	458.398),
(131,	'mu',	'Oman',	85.719),
(132,	'pk',	'Pakistan',	282.325),
(133,	'ps',	'Palau',	0.242),
(134,	'pm',	'Panama',	64.366),
(135,	'pp',	'PapuaNewGuinea',	40.895),
(136,	'pa',	'Paraguay',	39.197),
(137,	'pe',	'Peru',	231.691),
(138,	'rp',	'Philippines',	406.107),
(139,	'pl',	'Poland',	720.35),
(140,	'po',	'Portugal',	271.191),
(141,	'qa',	'Qatar',	180.883),
(142,	'ro',	'Romania',	314.876),
(143,	'rs',	'Russia',	1703.527),
(144,	'rw',	'Rwanda',	11.035),
(145,	'sc',	'SaintKittsandNevis',	40.895),
(146,	'st',	'SaintLucia',	40.895),
(147,	'vc',	'SaintVincentandtheGrenadines',	40.895),
(148,	'ws',	'Samoa',	0.808),
(149,	'sm',	'SanMarino',	40.895),
(150,	'tp',	'SaoTomeandPrincipe',	40.895),
(151,	'sa',	'SaudiArabia',	40.895),
(152,	'sg',	'Senegal',	30.039),
(153,	'ri',	'Serbia',	65.697),
(154,	'se',	'Seychelles',	1.751),
(155,	'sl',	'SierraLeone',	40.895),
(156,	'sn',	'Singapore',	396.995),
(157,	'lo',	'Slovakia',	127.497),
(158,	'si',	'Slovenia',	65.475),
(159,	'bp',	'SolomonIslands',	40.895),
(160,	'so',	'Somalia',	5.888),
(161,	'sf',	'SouthAfrica',	40.895),
(162,	'od',	'SouthSudan',	40.895),
(163,	'sp',	'Spain',	1570.91),
(164,	'ce',	'SriLanka',	40.895),
(165,	'su',	'Sudan',	37.769),
(166,	'ns',	'Suriname',	2.937),
(167,	'wz',	'Swaziland',	40.895),
(168,	'sw',	'Sweden',	660.918),
(169,	'sz',	'Switzerland',	862.819),
(170,	'sy',	'Syria',	9.357),
(171,	'ti',	'Tajikistan',	8.756),
(172,	'tz',	'Tanzania',	74.536),
(173,	'th',	'Thailand',	585.586),
(174,	'tt',	'Timor-Leste',	1.782),
(175,	'to',	'Togo',	9.357),
(176,	'tn',	'Tonga',	0.54),
(177,	'td',	'TrinidadandTobago',	63.741),
(178,	'ts',	'Tunisia',	45.454),
(179,	'tu',	'Turkey',	844.534),
(180,	'tx',	'Turkmenistan',	60.263),
(181,	'tv',	'Tuvalu',	0.07),
(182,	'ug',	'Uganda',	47),
(183,	'up',	'Ukraine',	203.925),
(184,	'ae',	'UnitedArabEmirates',	71.716736886421),
(185,	'uk',	'UnitedKingdom',	3442.205),
(186,	'us',	'UnitedStates',	24796.076),
(187,	'uy',	'Uruguay',	63.741),
(188,	'uz',	'Uzbekistan',	72.762),
(189,	'nh',	'Vanuatu',	1.06),
(190,	'vt',	'HolySee(VaticanCity)',	74.1834297015147),
(191,	've',	'Venezuela',	43.546),
(192,	'vm',	'Vietnam',	415.493),
(193,	'ym',	'Yemen',	20.02),
(194,	'za',	'Zambia',	23.967),
(195,	'zi',	'Zimbabwe',	27.806),
(196,	'tw',	'Taiwan',	850.528),
(197,	'ee',	'EuropeanUnion',	74.18),
(199,	'kt',	'ChristmasIsland',	78.1),
(200,	'ck',	'Cocos(Keeling)Islands',	74.47),
(203,	'nf',	'NorfolkIsland',	65.18),
(204,	'hk',	'HongKong',	50.41),
(205,	'mc',	'Macau',	73.38),
(206,	'fo',	'FaroeIslands',	71.71),
(207,	'gl',	'Greenland',	73.39),
(211,	'nc',	'NewCaledonia',	59.73),
(215,	'wf',	'WallisandFutuna',	49.55),
(218,	'sk',	'SintMaarten',	46.08),
(219,	'cw',	'CookIslands',	50.27),
(220,	'ne',	'Niue',	58.62),
(221,	'tl',	'Tokelau',	55.77),
(224,	'sv',	'Svalbard',	43.09),
(226,	'av',	'Anguilla',	56.8),
(227,	'bd',	'Bermuda',	46.73),
(229,	'vi',	'BritishVirginIslands',	55.52),
(230,	'cj',	'CaymanIslands',	51.64),
(232,	'fk',	'FalklandIslands(IslasMalvinas)',	68.58),
(233,	'gi',	'Gibraltar',	73.82),
(234,	'gk',	'Guernsey',	67.49),
(235,	'je',	'Jersey',	51.2),
(236,	'im',	'IsleofMan',	70.53),
(237,	'mh',	'Montserrat',	63.91),
(238,	'pc',	'PitcairnIslands',	62.4),
(239,	'sh',	'SaintHelena_Ascension_andTristandaCunha',	61.82),
(241,	'tk',	'TurksandCaicosIslands',	74.38),
(242,	'aq',	'AmericanSamoa',	60.48),
(243,	'gq',	'Guam',	59.04),
(245,	'cq',	'NorthernMarianaIslands',	42.72),
(246,	'rq',	'PuertoRico',	65.6),
(247,	'vq',	'VirginIslands',	50.47),
(251,	'gz',	'GazaStrip',	46.09),
(252,	'pf',	'ParacelIslands',	67.24),
(253,	'pg',	'SpratlyIslands',	51.85),
(254,	'we',	'WestBank',	73.15),
(255,	'wi',	'WesternSahara',	43),
(256,	'xq',	'ArcticOcean',	0),
(257,	'zh',	'AtlanticOcean',	0),
(258,	'xo',	'IndianOcean',	0),
(259,	'zn',	'PacificOcean',	0),
(260,	'oo',	'SouthernOcean',	0);

-- Let's see what our table looks like printing out some rows
SELECT * FROM worldgdp
LIMIT 10;
-- First thing we want to do is the summary statistics:
SELECT MIN(gdp) AS min_gdp,
       MAX(gdp) AS max_gdp,
       AVG(gdp) AS avg_gdp
FROM worldgdp;

-- Our result shows us that the least GDP is zero which is not possible, let's investigate this further
SELECT *
FROM worldgdp
WHERE gdp= 0;
-- Given the results, we can see that the results are right as it is impossible for these locations to generate GDPs. 
-- To get the correct minimum GDP, let's recalculate our summary but exempt these locations
SELECT MIN(gdp) AS min_gdp,
       MAX(gdp) AS max_gdp,
       AVG(gdp) AS avg_gdp
FROM worldgdp
WHERE gdp > 0;
-- So, using the average, let us categorize our countries into 2 categories:
-- POOR COUNTRIES
SELECT *
FROM worldgdp
WHERE gdp <= 431.732 AND gdp > 0;
-- RICH COUNTRIES
SELECT *
FROM worldgdp
WHERE gdp > 431.732;


-- TABLE 4: ACCESS TO ELECTRICITY
-- Now we want to create another table that shows ACCESS TO ELECTRICITY in each country using country id as primary key
CREATE TABLE worldpower(
    id INTEGER NOT NULL,
    city_code varchar(255) NOT NULL, 
    city_name varchar(255) NOT NULL, 
    city_power float, 
    PRIMARY KEY (id)
); 
INSERT INTO worldpower
(id, city_code, city_name, city_power)
VALUES
(1,	'af',	'Afghanistan',	97.7),
(2,	'al',	'Albania',	100),
(3,	'ag',	'Algeria',	99.8),
(4,	'an',	'Andorra',	100),
(5,	'ao',	'Angola',	46.9),
(6,	'ac',	'AntiguaandBarbuda',	100),
(7,	'ar',	'Argentina',	100),
(8,	'am',	'Armenia',	100),
(9,	'as',	'Australia',	100),
(10,	'au',	'Austria',	100),
(11,	'aj',	'Azerbaijan',	100),
(12,	'bf',	'Bahamas_The',	100),
(13,	'ba',	'Bahrain',	100),
(14,	'bg',	'Bangladesh',	96.2),
(15,	'bb',	'Barbados',	100),
(16,	'bo',	'Belarus',	100),
(17,	'be',	'Belgium',	100),
(18,	'bh',	'Belize',	97.1),
(19,	'bn',	'Benin',	41.4),
(20,	'bt',	'Bhutan',	100),
(21,	'bl',	'Bolivia',	97.6),
(22,	'bk',	'BosniaandHerzegovina',	100.01),
(23,	'bc',	'Botswana',	72.56),
(24,	'br',	'Brazil',	100),
(25,	'bx',	'Brunei',	100),
(26,	'bu',	'Bulgaria',	99.7),
(27,	'uv',	'BurkinaFaso',	19.23),
(28,	'bm',	'Burma',	60),
(29,	'by',	'Burundi',	11.7),
(30,	'cb',	'Cambodia',	86.4),
(31,	'cm',	'Cameroon',	64.7),
(32,	'ca',	'Canada',	100),
(33,	'cv',	'CaboVerde',	94.2),
(34,	'ct',	'CentralAfricanRepublic',	15.5),
(35,	'cd',	'Chad',	11.1),
(36,	'ci',	'Chile',	100),
(37,	'ch',	'China',	100),
(38,	'co',	'Colombia',	100),
(39,	'cn',	'Comoros',	86.7),
(40,	'cg',	'Congo_DemocraticRepublicofthe',	19.1),
(41,	'cf',	'Congo_Republicofthe',	49.5),
(42,	'cs',	'CostaRica',	99.9),
(43,	'iv',	'Coted\'Ivoire',	69.7),
(44,	'hr',	'Croatia',	100),
(45,	'cu',	'Cuba',	100),
(46,	'cy',	'Cyprus',	100),
(47,	'ez',	'CzechRepublic',	100),
(48,	'da',	'Denmark',	100),
(49,	'dj',	'Djibouti',	61.8),
(50,	'do',	'Dominica',	100),
(51,	'dr',	'DominicanRepublic',	100),
(52,	'ec',	'Ecuador',	98.8),
(53,	'eg',	'Egypt',	100),
(54,	'es',	'ElSalvador',	100),
(55,	'ek',	'EquatorialGuinea',	66.7),
(56,	'er',	'Eritrea',	52.2),
(57,	'en',	'Estonia',	100),
(58,	'et',	'Ethiopia',	51.1),
(59,	'fj',	'Fiji',	100),
(60,	'fi',	'Finland',	100),
(61,	'fr',	'France',	100),
(62,	'gb',	'Gabon',	91.6),
(63,	'ga',	'Gambia_The',	62.3),
(64,	'gg',	'Georgia',	100),
(65,	'gm',	'Germany',	100),
(66,	'gh',	'Ghana',	85.9),
(67,	'gr',	'Greece',	100),
(68,	'gj',	'Grenada',	93.6),
(69,	'gt',	'Guatemala',	97.1),
(70,	'gv',	'Guinea',	44.7),
(71,	'pu',	'Guinea-Bissau',	33.3),
(72,	'gy',	'Guyana',	92.5),
(73,	'ha',	'Haiti',	46.9),
(74,	'ho',	'Honduras',	93.2),
(75,	'hu',	'Hungary',	100),
(76,	'ic',	'Iceland',	100),
(77,	'in',	'India',	99),
(78,	'id',	'Indonesia',	96.9),
(79,	'ir',	'Iran',	100),
(80,	'iz',	'Iraq',	100),
(81,	'ei',	'Ireland',	100),
(82,	'is',	'Israel',	100),
(83,	'it',	'Italy',	100),
(84,	'jm',	'Jamaica',	100),
(85,	'ja',	'Japan',	100),
(86,	'jo',	'Jordan',	99.9),
(87,	'kz',	'Kazakhstan',	100),
(88,	'ke',	'Kenya',	71.4),
(89,	'kr',	'Kiribati',	92),
(90,	'kn',	'Korea_North',	52.3),
(91,	'ks',	'Korea_South',	100),
(92,	'kv',	'Kosovo',	100),
(93,	'ku',	'Kuwait',	100),
(94,	'kg',	'Kyrgyzstan',	100),
(95,	'la',	'Laos',	100),
(96,	'lg',	'Latvia',	100),
(97,	'le',	'Lebanon',	100),
(98,	'lt',	'Lesotho',	47.4),
(99,	'li',	'Liberia',	27.5),
(100,	'ly',	'Libya',	69.7),
(101,	'ls',	'Liechtenstein',	100),
(102,	'lh',	'Lithuania',	100),
(103,	'lu',	'Luxembourg',	100),
(104,	'mk',	'Macedonia',	100),
(105,	'ma',	'Madagascar',	33.7),
(106,	'mi',	'Malawi',	14.9),
(107,	'my',	'Malaysia',	100),
(108,	'mv',	'Maldives',	100),
(109,	'ml',	'Mali',	50.6),
(110,	'mt',	'Malta',	100),
(111,	'rm',	'MarshallIslands',	99.2),
(112,	'mr',	'Mauritania',	47.3),
(113,	'mp',	'Mauritius',	99.7),
(114,	'mx',	'Mexico',	99.4),
(115,	'fm',	'Micronesia_FederatedStatesof',	82.9),
(116,	'md',	'Moldova',	100),
(117,	'mn',	'Monaco',	100),
(118,	'mg',	'Mongolia',	98.1),
(119,	'mj',	'Montenegro',	100),
(120,	'mo',	'Morocco',	100),
(121,	'mz',	'Mozambique',	30.6),
(122,	'wa',	'Namibia',	56.3),
(123,	'nr',	'Nauru',	70.4),
(124,	'np',	'Nepal',	89.9),
(125,	'nl',	'Netherlands',	100),
(126,	'nz',	'NewZealand',	100),
(127,	'nu',	'Nicaragua',	88.9),
(128,	'ng',	'Niger',	19.3),
(129,	'ni',	'Nigeria',	55.4),
(130,	'no',	'Norway',	100),
(131,	'mu',	'Oman',	100),
(132,	'pk',	'Pakistan',	75.4),
(133,	'ps',	'Palau',	100),
(134,	'pm',	'Panama',	96.7),
(135,	'pp',	'PapuaNewGuinea',	60.4),
(136,	'pa',	'Paraguay',	100),
(137,	'pe',	'Peru',	99.3),
(138,	'rp',	'Philippines',	96.8),
(139,	'pl',	'Poland',	100),
(140,	'po',	'Portugal',	100),
(141,	'qa',	'Qatar',	100),
(142,	'ro',	'Romania',	100),
(143,	'rs',	'Russia',	100),
(144,	'rw',	'Rwanda',	46.6),
(145,	'sc',	'SaintKittsandNevis',	100),
(146,	'st',	'SaintLucia',	100),
(147,	'vc',	'SaintVincentandtheGrenadines',	100),
(148,	'ws',	'Samoa',	100),
(149,	'sm',	'SanMarino',	100),
(150,	'tp',	'SaoTomeandPrincipe',	76.6),
(151,	'sa',	'SaudiArabia',	100),
(152,	'sg',	'Senegal',	70.4),
(153,	'ri',	'Serbia',	100),
(154,	'se',	'Seychelles',	100),
(155,	'sl',	'SierraLeone',	26.2),
(156,	'sn',	'Singapore',	100),
(157,	'lo',	'Slovakia',	100),
(158,	'si',	'Slovenia',	100),
(159,	'bp',	'SolomonIslands',	73.3),
(160,	'so',	'Somalia',	49.7),
(161,	'sf',	'SouthAfrica',	84.4),
(162,	'od',	'SouthSudan',	7.2),
(163,	'sp',	'Spain',	100),
(164,	'ce',	'SriLanka',	100),
(165,	'su',	'Sudan',	55.4),
(166,	'ns',	'Suriname',	98.2),
(167,	'wz',	'Swaziland',	100),
(168,	'sw',	'Sweden',	100),
(169,	'sz',	'Switzerland',	100),
(170,	'sy',	'Syria',	89.1),
(171,	'ti',	'Tajikistan',	99.8),
(172,	'tz',	'Tanzania',	39.9),
(173,	'th',	'Thailand',	100),
(174,	'tt',	'Timor-Leste',	96.1),
(175,	'to',	'Togo',	54),
(176,	'tn',	'Tonga',	100),
(177,	'td',	'TrinidadandTobago',	100),
(178,	'ts',	'Tunisia',	100),
(179,	'tu',	'Turkey',	100),
(180,	'tx',	'Turkmenistan',	100),
(181,	'tv',	'Tuvalu',	99.7),
(182,	'ug',	'Uganda',	42.1),
(183,	'up',	'Ukraine',	100),
(184,	'ae',	'UnitedArabEmirates',	100),
(185,	'uk',	'UnitedKingdom',	100),
(186,	'us',	'UnitedStates',	100),
(187,	'uy',	'Uruguay',	100),
(188,	'uz',	'Uzbekistan',	100),
(189,	'nh',	'Vanuatu',	67.3),
(190,	'vt',	'HolySee(VaticanCity)',	99.4),
(191,	've',	'Venezuela',	100),
(192,	'vm',	'Vietnam',	100),
(193,	'ym',	'Yemen',	73.8),
(194,	'za',	'Zambia',	44.5),
(195,	'zi',	'Zimbabwe',	52.7),
(196,	'tw',	'Taiwan',	100),
(197,	'ee',	'EuropeanUnion',	100),
(199,	'kt',	'ChristmasIsland',	100),
(200,	'ck',	'Cocos(Keeling)Islands',	100),
(203,	'nf',	'NorfolkIsland',	99.2),
(204,	'hk',	'HongKong',	100),
(205,	'mc',	'Macau',	73.3),
(206,	'fo',	'FaroeIslands',	99.4),
(207,	'gl',	'Greenland',	100),
(211,	'nc',	'NewCaledonia',	46.9),
(215,	'wf',	'WallisandFutuna',	93.2),
(218,	'sk',	'SintMaarten',	100),
(219,	'cw',	'CookIslands',	100),
(220,	'ne',	'Niue',	99),
(221,	'tl',	'Tokelau',	96.9),
(224,	'sv',	'Svalbard',	100),
(226,	'av',	'Anguilla',	100),
(227,	'bd',	'Bermuda',	100),
(229,	'vi',	'BritishVirginIslands',	99.9),
(230,	'cj',	'CaymanIslands',	100),
(232,	'fk',	'FalklandIslands(IslasMalvinas)',	71.4),
(233,	'gi',	'Gibraltar',	92),
(234,	'gk',	'Guernsey',	52.3),
(235,	'je',	'Jersey',	100),
(236,	'im',	'IsleofMan',	100),
(237,	'mh',	'Montserrat',	100),
(238,	'pc',	'PitcairnIslands',	100),
(239,	'sh',	'SaintHelena_Ascension_andTristandaCunha',	100),
(241,	'tk',	'TurksandCaicosIslands',	100),
(242,	'aq',	'AmericanSamoa',	99.9),
(243,	'gq',	'Guam',	100),
(245,	'cq',	'NorthernMarianaIslands',	71.4),
(246,	'rq',	'PuertoRico',	92),
(247,	'vq',	'VirginIslands',	52.3),
(251,	'gz',	'GazaStrip',	100),
(252,	'pf',	'ParacelIslands',	100),
(253,	'pg',	'SpratlyIslands',	100),
(254,	'we',	'WestBank',	100),
(255,	'wi',	'WesternSahara', 100);

-- Let's see what our table looks like printing out some rows
SELECT * FROM worldpower
LIMIT 10;
-- First thing we want to do is the summary statistics:
SELECT MIN(city_power) AS min_power,
       MAX(city_power) AS max_power,
       AVG(city_power) AS avg_power
FROM worldpower;
-- So, using the average, let us categorize our countries into 2 categories:
-- COUNTRIES WITH POOR ELECTRICITY
SELECT *
FROM worldpower
WHERE city_power <= 86.81;
-- COUNTRIES WITH GOOD ELECTRICITY
SELECT *
FROM worldpower
WHERE city_power > 86.81;

-- TABLE 5: RENEWABLE ENERGY (SUSTAINABLITY)
-- Now we want to create another table that shows commitment to RENEWABLE ENERGY in each country using country id as primary key
CREATE TABLE worldenergy(
    id INTEGER NOT NULL,
    city_code varchar(255) NOT NULL, 
    city_name varchar(255) NOT NULL, 
    city_energy float, 
    PRIMARY KEY (id)
); 
INSERT INTO worldenergy
(id, city_code, city_name, city_energy)
VALUES
(1,	'af',	'Afghanistan',	18.5),
(2,	'al',	'Albania',	100),
(3,	'ag',	'Algeria',	99.8),
(4,	'an',	'Andorra',	100),
(5,	'ao',	'Angola',	46.9),
(6,	'ac',	'AntiguaandBarbuda',	100),
(7,	'ar',	'Argentina',	100),
(8,	'am',	'Armenia',	100),
(9,	'as',	'Australia',	100),
(10,	'au',	'Austria',	100),
(11,	'aj',	'Azerbaijan',	100),
(12,	'bf',	'Bahamas_The',	100),
(13,	'ba',	'Bahrain',	100),
(14,	'bg',	'Bangladesh',	96.2),
(15,	'bb',	'Barbados',	100),
(16,	'bo',	'Belarus',	100),
(17,	'be',	'Belgium',	100),
(18,	'bh',	'Belize',	97.1),
(19,	'bn',	'Benin',	41.4),
(20,	'bt',	'Bhutan',	100),
(21,	'bl',	'Bolivia',	97.6),
(22,	'bk',	'BosniaandHerzegovina',	100),
(23,	'bc',	'Botswana',	72),
(24,	'br',	'Brazil',	100),
(25,	'bx',	'Brunei',	100),
(26,	'bu',	'Bulgaria',	99.7),
(27,	'uv',	'BurkinaFaso',	19),
(28,	'bm',	'Burma',	60),
(29,	'by',	'Burundi',	11.7),
(30,	'cb',	'Cambodia',	86.4),
(31,	'cm',	'Cameroon',	64.7),
(32,	'ca',	'Canada',	100),
(33,	'cv',	'CaboVerde',	94.2),
(34,	'ct',	'CentralAfricanRepublic',	15.5),
(35,	'cd',	'Chad',	11.1),
(36,	'ci',	'Chile',	100),
(37,	'ch',	'China',	100),
(38,	'co',	'Colombia',	100),
(39,	'cn',	'Comoros',	86.7),
(40,	'cg',	'Congo_DemocraticRepublicofthe',	19.1),
(41,	'cf',	'Congo_Republicofthe',	49.5),
(42,	'cs',	'CostaRica',	99.9),
(43,	'iv',	'Coted\'Ivoire',	69.7),
(44,	'hr',	'Croatia',	100),
(45,	'cu',	'Cuba',	100),
(46,	'cy',	'Cyprus',	100),
(47,	'ez',	'CzechRepublic',	100),
(48,	'da',	'Denmark',	100),
(49,	'dj',	'Djibouti',	61.8),
(50,	'do',	'Dominica',	100),
(51,	'dr',	'DominicanRepublic',	100),
(52,	'ec',	'Ecuador',	98.8),
(53,	'eg',	'Egypt',	100),
(54,	'es',	'ElSalvador',	100),
(55,	'ek',	'EquatorialGuinea',	66.7),
(56,	'er',	'Eritrea',	52.2),
(57,	'en',	'Estonia',	100),
(58,	'et',	'Ethiopia',	51.1),
(59,	'fj',	'Fiji',	100),
(60,	'fi',	'Finland',	100),
(61,	'fr',	'France',	100),
(62,	'gb',	'Gabon',	91.6),
(63,	'ga',	'Gambia_The',	62.3),
(64,	'gg',	'Georgia',	100),
(65,	'gm',	'Germany',	100),
(66,	'gh',	'Ghana',	85.9),
(67,	'gr',	'Greece',	100),
(68,	'gj',	'Grenada',	93.6),
(69,	'gt',	'Guatemala',	97.1),
(70,	'gv',	'Guinea',	44.7),
(71,	'pu',	'Guinea-Bissau',	33.3),
(72,	'gy',	'Guyana',	92.5),
(73,	'ha',	'Haiti',	46.9),
(74,	'ho',	'Honduras',	93.2),
(75,	'hu',	'Hungary',	100),
(76,	'ic',	'Iceland',	100),
(77,	'in',	'India',	99),
(78,	'id',	'Indonesia',	96.9),
(79,	'ir',	'Iran',	100),
(80,	'iz',	'Iraq',	100),
(81,	'ei',	'Ireland',	100),
(82,	'is',	'Israel',	100),
(83,	'it',	'Italy',	100),
(84,	'jm',	'Jamaica',	100),
(85,	'ja',	'Japan',	100),
(86,	'jo',	'Jordan',	99.9),
(87,	'kz',	'Kazakhstan',	100),
(88,	'ke',	'Kenya',	71.4),
(89,	'kr',	'Kiribati',	92),
(90,	'kn',	'Korea_North',	52.3),
(91,	'ks',	'Korea_South',	100),
(92,	'kv',	'Kosovo',	100),
(93,	'ku',	'Kuwait',	100),
(94,	'kg',	'Kyrgyzstan',	100),
(95,	'la',	'Laos',	100),
(96,	'lg',	'Latvia',	100),
(97,	'le',	'Lebanon',	100),
(98,	'lt',	'Lesotho',	47.4),
(99,	'li',	'Liberia',	27.5),
(100,	'ly',	'Libya',	69.7),
(101,	'ls',	'Liechtenstein',	100),
(102,	'lh',	'Lithuania',	100),
(103,	'lu',	'Luxembourg',	100),
(104,	'mk',	'Macedonia',	100),
(105,	'ma',	'Madagascar',	33.7),
(106,	'mi',	'Malawi',	14.9),
(107,	'my',	'Malaysia',	100),
(108,	'mv',	'Maldives',	100),
(109,	'ml',	'Mali',	50.6),
(110,	'mt',	'Malta',	100),
(111,	'rm',	'MarshallIslands',	99.2),
(112,	'mr',	'Mauritania',	47.3),
(113,	'mp',	'Mauritius',	99.7),
(114,	'mx',	'Mexico',	99.4),
(115,	'fm',	'Micronesia_FederatedStatesof',	82.9),
(116,	'md',	'Moldova',	100),
(117,	'mn',	'Monaco',	100),
(118,	'mg',	'Mongolia',	98.1),
(119,	'mj',	'Montenegro',	100),
(120,	'mo',	'Morocco',	100),
(121,	'mz',	'Mozambique',	30.6),
(122,	'wa',	'Namibia',	56.3),
(123,	'nr',	'Nauru',	70.4),
(124,	'np',	'Nepal',	89.9),
(125,	'nl',	'Netherlands',	100),
(126,	'nz',	'NewZealand',	100),
(127,	'nu',	'Nicaragua',	88.9),
(128,	'ng',	'Niger',	19.3),
(129,	'ni',	'Nigeria',	55.4),
(130,	'no',	'Norway',	100),
(131,	'mu',	'Oman',	100),
(132,	'pk',	'Pakistan',	75.4),
(133,	'ps',	'Palau',	100),
(134,	'pm',	'Panama',	96.7),
(135,	'pp',	'PapuaNewGuinea',	60.4),
(136,	'pa',	'Paraguay',	100),
(137,	'pe',	'Peru',	99.3),
(138,	'rp',	'Philippines',	96.8),
(139,	'pl',	'Poland',	100),
(140,	'po',	'Portugal',	100),
(141,	'qa',	'Qatar',	100),
(142,	'ro',	'Romania',	100),
(143,	'rs',	'Russia',	100),
(144,	'rw',	'Rwanda',	46.6),
(145,	'sc',	'SaintKittsandNevis',	100),
(146,	'st',	'SaintLucia',	100),
(147,	'vc',	'SaintVincentandtheGrenadines',	100),
(148,	'ws',	'Samoa',	100),
(149,	'sm',	'SanMarino',	100),
(150,	'tp',	'SaoTomeandPrincipe',	76.6),
(151,	'sa',	'SaudiArabia',	100),
(152,	'sg',	'Senegal',	70.4),
(153,	'ri',	'Serbia',	100),
(154,	'se',	'Seychelles',	100),
(155,	'sl',	'SierraLeone',	26.2),
(156,	'sn',	'Singapore',	100),
(157,	'lo',	'Slovakia',	100),
(158,	'si',	'Slovenia',	100),
(159,	'bp',	'SolomonIslands',	73.3),
(160,	'so',	'Somalia',	49.7),
(161,	'sf',	'SouthAfrica',	84.4),
(162,	'od',	'SouthSudan',	7.2),
(163,	'sp',	'Spain',	100),
(164,	'ce',	'SriLanka',	100),
(165,	'su',	'Sudan',	55.4),
(166,	'ns',	'Suriname',	98.2),
(167,	'wz',	'Swaziland',	100),
(168,	'sw',	'Sweden',	100),
(169,	'sz',	'Switzerland',	100),
(170,	'sy',	'Syria',	89.1),
(171,	'ti',	'Tajikistan',	99.8),
(172,	'tz',	'Tanzania',	39.9),
(173,	'th',	'Thailand',	100),
(174,	'tt',	'Timor-Leste',	96.1),
(175,	'to',	'Togo',	54),
(176,	'tn',	'Tonga',	100),
(177,	'td',	'TrinidadandTobago',	100),
(178,	'ts',	'Tunisia',	100),
(179,	'tu',	'Turkey',	100),
(180,	'tx',	'Turkmenistan',	100),
(181,	'tv',	'Tuvalu',	99.7),
(182,	'ug',	'Uganda',	42.1),
(183,	'up',	'Ukraine',	100),
(184,	'ae',	'UnitedArabEmirates',	100),
(185,	'uk',	'UnitedKingdom',	100),
(186,	'us',	'UnitedStates',	100),
(187,	'uy',	'Uruguay',	100),
(188,	'uz',	'Uzbekistan',	100),
(189,	'nh',	'Vanuatu',	67.3),
(190,	'vt',	'HolySee(VaticanCity)',	99.4),
(191,	've',	'Venezuela',	100),
(192,	'vm',	'Vietnam',	100),
(193,	'ym',	'Yemen',	73.8),
(194,	'za',	'Zambia',	44.5),
(195,	'zi',	'Zimbabwe',	52.7),
(196,	'tw',	'Taiwan',	100),
(197,	'ee',	'EuropeanUnion',	100),
(199,	'kt',	'ChristmasIsland',	100),
(200,	'ck',	'Cocos(Keeling)Islands',	100),
(203,	'nf',	'NorfolkIsland',	99.2),
(204,	'hk',	'HongKong',	100),
(205,	'mc',	'Macau',	73.3),
(206,	'fo',	'FaroeIslands',	99.4),
(207,	'gl',	'Greenland',	100),
(211,	'nc',	'NewCaledonia',	46.9),
(215,	'wf',	'WallisandFutuna',	93.2),
(218,	'sk',	'SintMaarten',	100),
(219,	'cw',	'CookIslands',	100),
(220,	'ne',	'Niue',	99),
(221,	'tl',	'Tokelau',	96.9),
(224,	'sv',	'Svalbard',	100),
(226,	'av',	'Anguilla',	100),
(227,	'bd',	'Bermuda',	100),
(229,	'vi',	'BritishVirginIslands',	99.9),
(230,	'cj',	'CaymanIslands',	100),
(232,	'fk',	'FalklandIslands(IslasMalvinas)',	71.4),
(233,	'gi',	'Gibraltar',	92),
(234,	'gk',	'Guernsey',	52.3),
(235,	'je',	'Jersey',	100),
(236,	'im',	'IsleofMan',	100),
(237,	'mh',	'Montserrat',	100),
(238,	'pc',	'PitcairnIslands',	100),
(239,	'sh',	'SaintHelena_Ascension_andTristandaCunha',	100),
(241,	'tk',	'TurksandCaicosIslands',	100),
(242,	'aq',	'AmericanSamoa',	99.9),
(243,	'gq',	'Guam',	100),
(245,	'cq',	'NorthernMarianaIslands',	71.4),
(246,	'rq',	'PuertoRico',	92),
(247,	'vq',	'VirginIslands',	52.3),
(251,	'gz',	'GazaStrip',	100),
(252,	'pf',	'ParacelIslands',	100),
(253,	'pg',	'SpratlyIslands',	100),
(254,	'we',	'WestBank',	100),
(255,	'wi',	'WesternSahara',	100);

-- Let's see what our table looks like printing out some rows
SELECT * FROM worldenergy
LIMIT 10;
-- First thing we want to do is the summary statistics:
SELECT MIN(city_energy) AS min_energy,
       MAX(city_energy) AS max_energy,
       AVG(city_energy) AS avg_energy
FROM worldenergy;

-- So, using the average, let us categorize our countries into 2 categories:
-- LESS SUSTAINABLE COUNTRIES
SELECT *
FROM worldenergy
WHERE city_energy <= 86.47;
-- MORE SUSTAINABLE COUNTRIES
SELECT *
FROM worldenergy
WHERE city_energy > 86.47;

-- REQUIREMENT 3: Using any type of the joins create a view that combines multiple tables in a logical way

CREATE VIEW worldindicators AS
SELECT wf.id, wf.city_code, wf.city_name, wf.population,
       wc.crime_index, wg.gdp, wp.city_power, we.city_energy
FROM worldfacts wf
LEFT JOIN worldcrime wc ON wf.city_code = wc.city_code
LEFT JOIN worldgdp wg ON wf.city_code = wg.city_code
LEFT JOIN worldpower wp ON wf.city_code = wp.city_code
LEFT JOIN worldenergy we ON wf.city_code = we.city_code;

-- To view the worldindicators:
SELECT * FROM worldindicators;

-- REQUIREMENT 4: In your database, create a stored function that can be applied to a query in your DB
-- Let's suppose I want to create a function that retrieves the total population of a city when provided with the city's code.

DELIMITER //
-- The DELIMITER // and DELIMITER ; lines are used to change the statement delimiter temporarily so that the ;  in the function body doesn't end the CREATE FUNCTION statement.
CREATE FUNCTION getTotalPopulation(cityCode VARCHAR(255))
RETURNS INTEGER
DETERMINISTIC READS SQL DATA
-- This part is defining the function. 
-- It's saying that the function will return an integer and that it's deterministic (will always return the same result for the same input) 
-- and only reads SQL data (doesn't modify it).
BEGIN
    DECLARE total_population INTEGER;
    -- This line declares a variable named total_population which will be used to store the population of the city.
    SELECT population INTO total_population
    -- It selects the population from the worldfacts table where the city_code matches the one provided as an argument, and it stores that value in total_population.
    FROM worldfacts
    WHERE city_code = cityCode;
    RETURN total_population;
    -- This is the result that the function returns - the population of the city.
END//

-- Setting my delimiter back to ;
DELIMITER ; 
-- Using the created function, I can now call it using the SELECT statement to get total population per country
SELECT city_name, getTotalPopulation(city_code)
FROM worldfacts;

-- REQUIREMENT 5: Prepare an example query with a subquery to demonstrate how to extract data from your DB for analysis.
-- I had shown this earlier in the most dangerous countries view
SELECT city_name, crime_index 
FROM worldcrime 
WHERE crime_index > 
(SELECT AVG(crime_index) 
FROM worldcrime);

-- REQUIREMENT 6: Create DB diagram where all table relations are shown. I did this on Tableau


-- SUMMARY:
-- Most populated country: China 1367485388
SELECT city_name, population 
FROM worldfacts 
WHERE population = (SELECT MAX(population) 
FROM worldfacts);
-- Least populated country: PitcairnIslands 48
SELECT city_name, population 
FROM worldfacts 
WHERE population = (SELECT MIN(population) 
FROM worldfacts);
-- Most dangerous country: Ukraine	Crime Index: 90.37
SELECT city_name, crime_index 
FROM worldcrime 
WHERE crime_index = (SELECT MAX(crime_index) 
FROM worldcrime);
-- Least dangerous country: Ireland Crime Index: 30.1
SELECT city_name, crime_index 
FROM worldcrime 
WHERE crime_index = (SELECT MIN(crime_index) 
FROM worldcrime);
-- Richest Country: UnitedStates 24796.1 (in USD BILLIONS)
SELECT city_name, gdp 
FROM worldgdp 
WHERE gdp = (SELECT MAX(gdp) 
FROM worldgdp);
-- Poorest Country: Tuvalu 0.07 (in USD BILLIONS)
SELECT city_name, gdp 
FROM worldgdp 
WHERE gdp = (
    SELECT MIN(gdp)
    FROM worldgdp
    WHERE gdp > 0);
-- Country with Best Electricity System: BosniaandHerzegovina 100.01 (% of population with good electricity)
SELECT city_name, city_power
FROM worldpower 
WHERE city_power = (SELECT MAX(city_power) 
FROM worldpower);
-- Country with Worst Electricity System: SouthSudan 7.2 (% of population with good electricity)
SELECT city_name, city_power
FROM worldpower 
WHERE city_power = (SELECT MIN(city_power) 
FROM worldpower);
-- Best Renewable Energy Country: List of countries
SELECT city_name, city_energy
FROM worldenergy 
WHERE city_energy = (SELECT MAX(city_energy) 
FROM worldenergy);
-- Worst Renewable Energy Country: SouthSudan
SELECT city_name, city_energy
FROM worldenergy 
WHERE city_energy = (SELECT MIN(city_energy) 
FROM worldenergy);



